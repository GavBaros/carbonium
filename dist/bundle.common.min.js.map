{"version":3,"file":"bundle.common.min.js","sources":["../src/miq.ts"],"sourcesContent":["export function $(arg: string, doc?: Document): any {\n  const nodelist = (doc || document).querySelectorAll(arg);\n  return new Proxy(nodelist, proxyHandler);\n}\n\n// Used by classList\nlet classListNodelist: NodeListOf<HTMLElement>;\n\nconst proxyHandler: ProxyHandler<NodeListOf<HTMLElement>> = {\n  get(target, prop) {\n    // Special case for classList\n    if (prop == 'classList') {\n      classListNodelist = target;\n      const propValue = Reflect.get(document.body, prop);\n      return new Proxy(propValue, proxyHandler);\n    }\n\n    // classList.add, contains, removeâ€¦\n    if (target instanceof DOMTokenList) {\n      const propValue = Reflect.get(document.body.classList, prop);\n\n      if (typeof propValue == 'function') {\n        return new Proxy<Function>(propValue, {\n          apply: function (target, thisArg, argumentsList) {\n            classListNodelist.forEach((el) => {\n              Reflect.apply(target, el.classList, argumentsList);\n            });\n            return new Proxy(classListNodelist, proxyHandler);\n          }\n        })\n      } else {\n        return propValue;\n      }\n    }\n\n    // Are we dealing with an Array function?\n    if (Array.prototype.hasOwnProperty(prop)) {\n      const propValue = Reflect.get(Array.prototype, prop);\n      if (typeof propValue == 'function') {\n        return new Proxy<Function>(propValue, {\n          apply: function (target, thisArg, argumentsList) {\n            const ret = Reflect.apply(target, thisArg, argumentsList);\n            // forEach returns same array instead of undefined\n            const newTarget = typeof ret != 'undefined' ? ret : thisArg\n            return new Proxy(newTarget, proxyHandler);\n          }\n        });\n      }\n    }\n\n    // Get property or call function on DOM elements\n    if (target.length > 0) {\n      // Might be DOM element specific, like input.select(),\n      // so use first array element to get reference\n      if (prop in target[0]) {\n        const propValue = Reflect.get(target[0], prop);\n        if (typeof propValue == 'function') {\n          return new Proxy(propValue, proxyDOMFunctionHandler);\n        } else {\n          return propValue;\n        }\n      }\n    } else {\n      // Empty list, targeted DOM element unknown,\n      // use document.body\n      if (prop in document.body) {\n        const propValue = Reflect.get(document.body, prop);\n        if (typeof propValue == 'function') {\n          return new Proxy(propValue, proxyDOMFunctionHandler);\n        } else {\n          return propValue;\n        }\n      }\n    }\n\n    // Default\n    return Reflect.get(target, prop);\n  },\n\n  // DOM property is set\n  set(target, prop, value) {\n    target.forEach((el) => {\n      Reflect.set(el, prop, value);\n    });\n    return true;\n  },\n};\n\nconst proxyDOMFunctionHandler: ProxyHandler<Function> = {\n  apply: function (target, thisArg, argumentsList) {\n    // Apply on individual elements\n    for (const el of thisArg) {\n      Reflect.apply(target, el, argumentsList);\n    }\n    return thisArg;\n  },\n}\n\n\n"],"names":["classListNodelist","proxyHandler","[object Object]","target","prop","propValue","Reflect","get","document","body","Proxy","DOMTokenList","classList","apply","thisArg","argumentsList","forEach","el","Array","prototype","hasOwnProperty","ret","length","proxyDOMFunctionHandler","set","value","arg","doc","nodelist","querySelectorAll"],"mappings":"aAMA,IAAIA,yDAEJ,MAAMC,EAAsD,CAC1DC,IAAIC,EAAQC,GAEV,GAAY,aAARA,EAAqB,CACvBJ,EAAoBG,EACpB,MAAME,EAAYC,QAAQC,IAAIC,SAASC,KAAML,GAC7C,OAAO,IAAIM,MAAML,EAAWJ,GAI9B,GAAIE,aAAkBQ,aAAc,CAClC,MAAMN,EAAYC,QAAQC,IAAIC,SAASC,KAAKG,UAAWR,GAEvD,MAAwB,mBAAbC,EACF,IAAIK,MAAgBL,EAAW,CACpCQ,MAAO,SAAUV,EAAQW,EAASC,GAIhC,OAHAf,EAAkBgB,QAASC,IACzBX,QAAQO,MAAMV,EAAQc,EAAGL,UAAWG,KAE/B,IAAIL,MAAMV,EAAmBC,MAIjCI,EAKX,GAAIa,MAAMC,UAAUC,eAAehB,GAAO,CACxC,MAAMC,EAAYC,QAAQC,IAAIW,MAAMC,UAAWf,GAC/C,GAAwB,mBAAbC,EACT,OAAO,IAAIK,MAAgBL,EAAW,CACpCQ,MAAO,SAAUV,EAAQW,EAASC,GAChC,MAAMM,EAAMf,QAAQO,MAAMV,EAAQW,EAASC,GAG3C,OAAO,IAAIL,WADqB,IAAPW,EAAqBA,EAAMP,EACxBb,MAOpC,GAAIE,EAAOmB,OAAS,GAGlB,GAAIlB,KAAQD,EAAO,GAAI,CACrB,MAAME,EAAYC,QAAQC,IAAIJ,EAAO,GAAIC,GACzC,MAAwB,mBAAbC,EACF,IAAIK,MAAML,EAAWkB,GAErBlB,QAMX,GAAID,KAAQI,SAASC,KAAM,CACzB,MAAMJ,EAAYC,QAAQC,IAAIC,SAASC,KAAML,GAC7C,MAAwB,mBAAbC,EACF,IAAIK,MAAML,EAAWkB,GAErBlB,EAMb,OAAOC,QAAQC,IAAIJ,EAAQC,IAI7BoB,IAAG,CAACrB,EAAQC,EAAMqB,KAChBtB,EAAOa,QAASC,IACdX,QAAQkB,IAAIP,EAAIb,EAAMqB,MAEjB,IAILF,EAAkD,CACtDV,MAAO,SAAUV,EAAQW,EAASC,GAEhC,IAAK,MAAME,KAAMH,EACfR,QAAQO,MAAMV,EAAQc,EAAIF,GAE5B,OAAOD,uBA9FOY,EAAaC,GAC7B,MAAMC,GAAYD,GAAOnB,UAAUqB,iBAAiBH,GACpD,OAAO,IAAIhB,MAAMkB,EAAU3B"}