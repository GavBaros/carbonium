{"version":3,"file":"bundle.min.js","sources":["../src/miq.ts"],"sourcesContent":["export function $(arg: string, doc?: Document): any {\n  const nodelist = (doc || document).querySelectorAll(arg);\n  return new Proxy(nodelist, proxyHandler);\n}\n\n// Used by classList\nlet classListNodelist: NodeListOf<HTMLElement>;\n\nconst proxyHandler: ProxyHandler<NodeListOf<HTMLElement>> = {\n  get(target, prop) {\n    // Special case for classList\n    if (prop == 'classList') {\n      classListNodelist = target;\n      const propValue = Reflect.get(document.body, prop);\n      return new Proxy(propValue, proxyHandler);\n    }\n\n    // classList.add, contains, removeâ€¦\n    if (target instanceof DOMTokenList) {\n      const propValue = Reflect.get(document.body.classList, prop);\n\n      if (typeof propValue == 'function') {\n        return new Proxy<Function>(propValue, {\n          apply: function (target, thisArg, argumentsList) {\n            classListNodelist.forEach((el) => {\n              Reflect.apply(target, el.classList, argumentsList);\n            });\n            return new Proxy(classListNodelist, proxyHandler);\n          }\n        })\n      } else {\n        return propValue;\n      }\n    }\n\n    // Are we dealing with an Array function?\n    if (Array.prototype.hasOwnProperty(prop)) {\n      const propValue = Reflect.get(Array.prototype, prop);\n      if (typeof propValue == 'function') {\n        return new Proxy<Function>(propValue, {\n          apply: function (target, thisArg, argumentsList) {\n            const ret = Reflect.apply(target, thisArg, argumentsList);\n            // forEach returns same array instead of undefined\n            const newTarget = typeof ret != 'undefined' ? ret : thisArg\n            return new Proxy(newTarget, proxyHandler);\n          }\n        });\n      }\n    }\n\n    // Get property or call function on DOM elements\n    if (target.length > 0) {\n      // Might be DOM element specific, like input.select(),\n      // so use first array element to get reference\n      if (prop in target[0]) {\n        const propValue = Reflect.get(target[0], prop);\n        if (typeof propValue == 'function') {\n          return new Proxy(propValue, proxyDOMFunctionHandler);\n        } else {\n          return propValue;\n        }\n      }\n    } else {\n      // Empty list, targeted DOM element unknown,\n      // use document.body\n      if (prop in document.body) {\n        const propValue = Reflect.get(document.body, prop);\n        if (typeof propValue == 'function') {\n          return new Proxy(propValue, proxyDOMFunctionHandler);\n        } else {\n          return propValue;\n        }\n      }\n    }\n\n    // Default\n    return Reflect.get(target, prop);\n  },\n\n  // DOM property is set\n  set(target, prop, value) {\n    target.forEach((el) => {\n      Reflect.set(el, prop, value);\n    });\n    return true;\n  },\n};\n\nconst proxyDOMFunctionHandler: ProxyHandler<Function> = {\n  apply: function (target, thisArg, argumentsList) {\n    // Apply on individual elements\n    for (const el of thisArg) {\n      Reflect.apply(target, el, argumentsList);\n    }\n    return thisArg;\n  },\n}\n\n\n"],"names":["$","arg","doc","nodelist","document","querySelectorAll","Proxy","proxyHandler","classListNodelist","[object Object]","target","prop","propValue","Reflect","get","body","DOMTokenList","classList","apply","thisArg","argumentsList","forEach","el","Array","prototype","hasOwnProperty","ret","length","proxyDOMFunctionHandler","set","value"],"mappings":"SAAgBA,EAAEC,EAAaC,GAC7B,MAAMC,GAAYD,GAAOE,UAAUC,iBAAiBJ,GACpD,OAAO,IAAIK,MAAMH,EAAUI,GAI7B,IAAIC,EAEJ,MAAMD,EAAsD,CAC1DE,IAAIC,EAAQC,GAEV,GAAY,aAARA,EAAqB,CACvBH,EAAoBE,EACpB,MAAME,EAAYC,QAAQC,IAAIV,SAASW,KAAMJ,GAC7C,OAAO,IAAIL,MAAMM,EAAWL,GAI9B,GAAIG,aAAkBM,aAAc,CAClC,MAAMJ,EAAYC,QAAQC,IAAIV,SAASW,KAAKE,UAAWN,GAEvD,MAAwB,mBAAbC,EACF,IAAIN,MAAgBM,EAAW,CACpCM,MAAO,SAAUR,EAAQS,EAASC,GAIhC,OAHAZ,EAAkBa,QAASC,IACzBT,QAAQK,MAAMR,EAAQY,EAAGL,UAAWG,KAE/B,IAAId,MAAME,EAAmBD,MAIjCK,EAKX,GAAIW,MAAMC,UAAUC,eAAed,GAAO,CACxC,MAAMC,EAAYC,QAAQC,IAAIS,MAAMC,UAAWb,GAC/C,GAAwB,mBAAbC,EACT,OAAO,IAAIN,MAAgBM,EAAW,CACpCM,MAAO,SAAUR,EAAQS,EAASC,GAChC,MAAMM,EAAMb,QAAQK,MAAMR,EAAQS,EAASC,GAG3C,OAAO,IAAId,WADqB,IAAPoB,EAAqBA,EAAMP,EACxBZ,MAOpC,GAAIG,EAAOiB,OAAS,GAGlB,GAAIhB,KAAQD,EAAO,GAAI,CACrB,MAAME,EAAYC,QAAQC,IAAIJ,EAAO,GAAIC,GACzC,MAAwB,mBAAbC,EACF,IAAIN,MAAMM,EAAWgB,GAErBhB,QAMX,GAAID,KAAQP,SAASW,KAAM,CACzB,MAAMH,EAAYC,QAAQC,IAAIV,SAASW,KAAMJ,GAC7C,MAAwB,mBAAbC,EACF,IAAIN,MAAMM,EAAWgB,GAErBhB,EAMb,OAAOC,QAAQC,IAAIJ,EAAQC,IAI7BkB,IAAG,CAACnB,EAAQC,EAAMmB,KAChBpB,EAAOW,QAASC,IACdT,QAAQgB,IAAIP,EAAIX,EAAMmB,MAEjB,IAILF,EAAkD,CACtDV,MAAO,SAAUR,EAAQS,EAASC,GAEhC,IAAK,MAAME,KAAMH,EACfN,QAAQK,MAAMR,EAAQY,EAAIF,GAE5B,OAAOD"}